!function(a){"use strict";window.simpleSharePointFormController=function(){function b(a,b,c){var d;d=[a].concat((b||[]).map(function(a){if(!e[a])throw new Error('module with the name "'+a+'" has not been registered');return e[a].init()})),c.apply(null,d)}function c(a,c){var d,e;return e=[{dependencies:a,callback:c}],{init:function(){return d||(d={},e.forEach(function(a){b(d,a.dependencies,a.callback)})),d},addPart:function(a,b){e.push({dependencies:a,callback:b})}}}function d(a){return{init:function(){return a}}}var e;return e={},Object.keys(a).forEach(function(b){e[b]=d(a[b])}),{create:function(a,b,d){e[a]?e[a].addPart(b,d):e[a]=c(b,d)},use:function(a,b){var c;c=a.map(function(a){if(!e[a])throw new Error('module with the name "'+a+'" has not been registered');return e[a].init()}),b.apply(null,c)}}}()}({window:window,moment:window.moment,SP:window.SP}),window.simpleSharePointFormController.create("utils.array",[],function(a){"use strict";a.remove=function(b,c){var d=b.indexOf(c);d!==-1&&(b.slice(d,1),a.remove(b,c))},a.contains=function(a,b){return a.indexOf(b)!==-1},a.containsAny=function(b,c){return c.some(function(c){return a.contains(b,c)})},a.singleOrNull=function(a,b){var c=a.filter(b);if(0===c.length)return null;if(1===c.length)return c[0];throw new Error("array contains more than one item")}}),window.simpleSharePointFormController.create("utils.converter",["utils.array"],function(a,b){"use strict";function c(a,c){return b.singleOrNull(c,function(b){return b.getId()===a})}function d(a,c){return b.singleOrNull(c,function(b){return b.getValue()===a})}a.toLookupValue=function(a,b){if(null===a)return null;if("number"==typeof a)return c(a,b);if("string"==typeof a)return d(a,b);if("getId"in a)return c(a.getId());throw new Error("lookup value is not valid")}}),window.simpleSharePointFormController.create("utils.document",[],function(a){"use strict";function b(a){return a.replace(/\s{2,}/g," ")}a.addEvent=function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c)},a.removeEvent=function(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener(b,c)},a.addClass=function(c,d){a.hasClass(c,d)||(c.className?c.className=b(c.className+" "+d):c.className=d)},a.removeClass=function(c,d){a.hasClass(c,d)&&(c.className=b(c.className.replace(d,"")))},a.toggleClass=function(b,c,d){d===!0?a.addClass(b,c):d===!1?a.removeClass(b,c):a.hasClass(b,c)?a.removeClass(b,c):a.addClass(b,c)},a.hasClass=function(a,b){return a.className.indexOf(b)!=-1},a.isVisible=function(a){return"none"!=window.getComputedStyle(a).display},a.addAttribute=function(a,b){a.setAttribute(b.name,b.value)},a.removeAttribute=function(a,b){a.removeAttribute(b.name)},a.toggleAttribute=function(b,c,d){d===!0?a.addAttribute(b,c):d===!1?a.removeAttribute(b,c):a.hasAttribute(b,c)?a.removeAttribute(b,c):a.addAttribute(b,c)},a.nodeListToArray=function(a){return Array.prototype.map.call(a,function(a){return a})}}),window.simpleSharePointFormController.create("utils.object",[],function(a){"use strict";a.mixin=function(b,c){return Object.keys(c).forEach(function(d){b[d]&&"object"==typeof b[d]&&"object"==typeof c[d]?a.mixin(b[d],c[d]):b[d]=c[d]}),b},a.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},a.isNumberOrNull=function(b){return null===b||a.isNumber(b)}}),window.simpleSharePointFormController.create("utils.sp",["window","SP"],function(a,b,c){"use strict";a.getSPPageContexInfo=function(){return b._spPageContextInfo},a.getCurrentCultureName=function(){return a.getSPPageContexInfo().currentCultureName},a.executeOrDelayUntilEventNotified=function(a,b){c.SOD.executeOrDelayUntilEventNotified(a,b)}}),window.simpleSharePointFormController.create("utils.string",["utils.array"],function(a,b){"use strict";a.format=function(){var a,b,c;return a=Array.prototype.slice.call(arguments),b=a.shift(),c=b.match(/\{.+?\}/g),c.forEach(function(c,d){var e=new RegExp(c.replace("{","\\{").replace("}","\\}"),"g");b=b.replace(e,a[d])}),b},a.zeroPad=function(a,b){var c;c="";for(var d=0;d<b-a.toString().length;d++)c+="0";return c+=a.toString()},a.valueOrNull=function(a){return b.contains(["",void 0],a)?null:a},a.valueOrEmpty=function(a){return b.contains(["",void 0],a)?"":a}}),window.simpleSharePointFormController.create("base",[],function(a){"use strict";a.createEventsObject=function(){var a,b;return a={subscribers:{}},b={on:function(b,c){a.subscribers[b]||(a.subscribers[b]=[]),a.subscribers[b].push(c)},off:function(b,c){if(!a.subscribers[b]||a.subscribers[b].indexOf(c)==-1)throw new Error('there is no "'+b+'" event to delete');a.subscribers[b].slice(a.subscribers[b].indexOf(c),1)},trigger:function(c,d){a.subscribers[c]&&a.subscribers[c].forEach(function(a){d||(d={}),d.srcElement||(d.srcElement=b),a(d)})}}}}),window.simpleSharePointFormController.create("base",[],function(a){"use strict";a.createLookupValue=function(a,b){return{getId:function(){return a},getValue:function(){return b}}}}),window.simpleSharePointFormController.create("base",["window","utils.object"],function(a,b,c){"use strict";a.createSpyObject=function(d){function e(){f.evaluatedState!=d.evaluateState()&&(g.trigger("clue"),d.autostop&&g.stopTracking())}var f,g;return f={tracking:null,evaluatedState:null},g=c.mixin(a.createEventsObject(),{startTracking:function(){f.evaluatedState=d.evaluateState(),f.tracking=b.setInterval(function(){e()},25)},stopTracking:function(){f.tracking&&(b.clearInterval(f.tracking),f.tracking=null,d.autostop||e())}}),d.autostart&&g.startTracking(),g}}),window.simpleSharePointFormController.create("form.controls",["base","utils.object"],function(a,b,c){"use strict";a.createBaseControl=function(a){return c.mixin(b.createEventsObject(),{getName:function(){return"form.controls.baseControl"},init:function(){throw new Error('method "init" is not implemented yet')},setValue:function(a){throw new Error('method "setValue" is not implemented yet')},getValue:function(){throw new Error('method "getValue" is not implemented yet')},toggleAvailability:function(a){throw new Error('method "toggleAvailability" is not implemented yet')}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object","utils.document"],function(a,b,c){"use strict";a.createBooleanControl=function(d){var e,f;return e={valueControl:d.valueContent.getElementsByTagName("input")[0]},f=b.mixin(a.createBaseControl(d),{getName:function(){return"form.controls.booleanControl"},init:function(){c.addEvent(e.valueControl,"change",function(a){f.trigger("change",{domEvent:a})})},setValue:function(a){e.valueControl.checked=!!a},getValue:function(){return e.valueControl.checked},toggleAvailability:function(a){c.toggleAttribute(e.valueControl,{name:"disabled",value:"disabled"},!a)}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object","utils.document","utils.array"],function(a,b,c,d){"use strict";a.createCheckboxChoiceControl=function(e){var f,g;return f={items:null},g=b.mixin(a.createBaseControl(),{getName:function(){return"form.controls.checkboxChoiceControl"},init:function(){f.items=c.nodeListToArray(e.inputs).map(function(a){return a.nextSibling.innerText}),c.nodeListToArray(e.inputs).map(function(a){c.addEvent(a,"change",function(){g.trigger("change")})})},getValue:function(){var a=c.nodeListToArray(e.inputs).filter(function(a){return a.checked}).map(function(a){return a.nextSibling.innerText});return a.length>0?a:null},setValue:function(a){if(null!==a&&!Array.isArray(a))throw new Error("multichoice value is not valid");if(c.nodeListToArray(e.inputs).filter(function(a){return!c.hasClass(a.parentNode,"simple-sp-form-hidden")}).forEach(function(b){b.checked=d.contains(a||[],b.nextSibling.innerText)}),g.getValue()&&a&&g.getValue().toString()!=a.toString())throw new Error("multichoice value is not valid")},getItems:function(){return f.items},setFilter:function(a,b){f.itemsFilter=a,b&&b.forEach(function(a){a.on("change",g.updateFilter)}),g.updateFilter()},updateFilter:function(){c.nodeListToArray(e.inputs).forEach(function(a){var b=f.itemsFilter(a.nextSibling.innerText);c.toggleAttribute(a,{name:"disabled",value:"disabled"},!!b.isDisabled),c.toggleClass(a.parentNode,"simple-sp-form-hidden",!!b.isHidden),b.isHidden&&(a.checked=!1)})},toggleAvailability:function(a){e.inputs.forEach(function(b){c.toggleAttribute(b,{name:"disabled",value:"disabled"},!a)})}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object","utils.document","base","utils.string","utils.array"],function(a,b,c,d,e,f){"use strict";a.createCustomChoiceControl=function(a){function g(){return h.checkedControl.checked}var h,i;return h={checkedControl:a.inputs[0],valueControl:a.inputs[1]},i=b.mixin(d.createEventsObject(),{getName:function(){return"form.controls.customChoiceControl"},init:function(){var b;b=i.getValue(),a.choiceControl.init(),c.addEvent(h.valueControl,"change",function(){i.trigger("change")}),c.addEvent(h.checkedControl,"click",function(){b!=i.getValue()&&(i.trigger("change"),b=i.getValue())}),a.choiceControl.on("change",function(){i.trigger("change")})},setValue:function(b){var c,d;try{a.choiceControl.setValue(b),h.valueControl.value="",h.checkedControl.checked=!1}catch(g){a.isMultiChoice&&(c=a.choiceControl.getValue()||[],d=b.filter(function(a){return!f.contains(c,a)}),b=d[d.length-1]),h.valueControl.value=e.valueOrEmpty(b),h.checkedControl.checked=null!==b}},getValue:function(){return g()?a.isMultiChoice?(a.choiceControl.getValue()||[]).concat(e.valueOrNull(h.valueControl.value)):e.valueOrNull(h.valueControl.value):a.choiceControl.getValue()},getItems:function(){return a.choiceControl.getItems()},setFilter:function(b,c){a.choiceControl.setFilter(b,c)},updateFilter:function(){a.choiceControl.filterItems()},toggleAvailability:function(b){a.inputs.forEach(function(a){c.toggleAttribute(a,{name:"disabled",value:"disabled"},!b)}),a.choiceControl.toggleAvailability(b)}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object","utils.document","utils.string","utils.array"],function(a,b,c,d,e){"use strict";a.createRadioButtonChoiceControl=function(f){var g,h;return g={items:null,itemsFilter:function(){return{isDisabled:!1,isHidden:!1}}},h=b.mixin(a.createBaseControl(),{getName:function(){return"form.controls.radioButtonChoiceControl"},init:function(){var a;a=h.getValue(),g.items=c.nodeListToArray(f.inputs).map(function(a){return a.value}),c.nodeListToArray(f.inputs).map(function(b){c.addEvent(b,"change",function(){a!=b.value&&(h.trigger("change"),a=b.value)})})},setValue:function(a){var b;if(c.nodeListToArray(f.inputs).filter(function(a){return!c.hasClass(a.parentNode,"simple-sp-form-hidden")}).forEach(function(c){c.checked=c.value==d.valueOrEmpty(a),c.checked&&(b=!0)}),!b)throw new Error("choice value is invalid")},getValue:function(){var a=e.singleOrNull(c.nodeListToArray(f.inputs),function(a){return a.checked});return a&&d.valueOrNull(a.value)},getItems:function(){return g.items},setFilter:function(a,b){g.itemsFilter=a,b&&b.forEach(function(a){a.on("change",h.updateFilter)}),h.updateFilter()},updateFilter:function(){c.nodeListToArray(f.inputs).forEach(function(a){var b=g.itemsFilter(a.value);c.toggleAttribute(a,{name:"disabled",value:"disabled"},!!b.isDisabled),c.toggleClass(a.parentNode,"simple-sp-form-hidden",!!b.isHidden),b.isHidden&&(a.checked=!1)})},toggleAvailability:function(a){f.inputs.forEach(function(b){c.toggleAttribute(b,{name:"disabled",value:"disabled"},!a)})}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object","utils.document","utils.string"],function(a,b,c,d){"use strict";a.createSelectChoiceControl=function(e){function f(){var a,b;b=e.select.value,a=g.filteredItems,g.filteredItems=[],c.nodeListToArray(e.select.options).forEach(function(b){a.push(e.select.removeChild(b))}),a.sort(function(a,b){return a.order==b.order?0:a.order<b.order?-1:1}).forEach(function(a){g.itemsFilter(a.value)?e.select.appendChild(a):g.filteredItems.push(a)}),e.select.value=b,e.select.value!=b&&(e.select.selectedIndex=0)}var g,h;return g={items:null,itemsFilter:function(){return!0},filteredItems:[]},h=b.mixin(a.createBaseControl(),{getName:function(){return"form.controls.selectChoiceControl"},init:function(){var a;c.nodeListToArray(e.select.options).forEach(function(a,b){a.order=b}),g.items=c.nodeListToArray(e.select.options).map(function(a){return a.value}),c.addEvent(e.select,"change",function(){h.trigger("change")}),e.checkChoice&&(a=h.getValue(),c.addEvent(e.checkChoice,"click",function(){a!=h.getValue()&&(h.trigger("change"),a=h.getValue())}))},setValue:function(a){if(null===a)e.select.selectedIndex=0;else if(e.select.value=d.valueOrEmpty(a),""!==e.select.value&&e.checkChoice&&(e.checkChoice.checked=!0),e.select.value!=d.valueOrEmpty(a))throw e.select.selectedIndex=0,new Error("choice value is invalid")},getValue:function(){return d.valueOrNull(e.select.value)},getItems:function(){return g.items},setFilter:function(a,b){g.itemsFilter=a,b&&b.forEach(function(a){a.on("change",h.updateFilter)}),h.updateFilter()},updateFilter:function(){f()},toggleAvailability:function(a){c.toggleAttribute(e.select,{name:"disabled",value:"disabled"},!a),e.checkChoice&&c.toggleAttribute(e.checkChoice,{name:"disabled",value:"disabled"},!a)}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object","utils.document","form.controlsHelper"],function(a,b,c,d){"use strict";a.createChoiceControl=function(e){var f,g;return f={choiceControl:null},g=b.mixin(a.createBaseControl(e),{getName:function(){return"form.controls.choiceControl"},init:function(){var b,h,i;b=e.valueContent.getElementsByTagName("select")[0],h=c.nodeListToArray(e.valueContent.getElementsByTagName("input")),i=b?a.createSelectChoiceControl({select:b,checkChoice:h[0]||null}):a.createRadioButtonChoiceControl({inputs:h}),f.choiceControl=d.allowCustomValue(h)?a.createCustomChoiceControl({inputs:h.splice(-2),choiceControl:i}):i,f.choiceControl.init(),f.choiceControl.on("change",function(){g.trigger("change")})},setValue:function(a){f.choiceControl.setValue(a)},getValue:function(){return f.choiceControl.getValue()},getItems:function(){return f.choiceControl.getItems()},setFilter:function(a,b){f.choiceControl.setFilter(a,b)},updateFilter:function(){f.choiceControl.filterItems()},toggleAvailability:function(a){f.choiceControl.toggleAvailability(a)}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object","utils.document","form.controlsHelper"],function(a,b,c,d){"use strict";a.createChoiceMultiControl=function(e){var f,g;return f={choiceControl:null},g=b.mixin(a.createBaseControl(e),{getName:function(){return"form.controls.choiceMultiControl"},init:function(){var b,h,i;b=c.nodeListToArray(e.valueContent.getElementsByTagName("input")),d.allowCustomValue(b)&&(h=b.splice(-2)),i=a.createCheckboxChoiceControl({inputs:b}),f.choiceControl=h?a.createCustomChoiceControl({inputs:h,choiceControl:i,isMultiChoice:!0}):i,f.choiceControl.init(),f.choiceControl.on("change",function(){g.trigger("change")})},setValue:function(a){f.choiceControl.setValue(a)},getValue:function(){return f.choiceControl.getValue()},getItems:function(){return f.choiceControl.getItems()},setFilter:function(a,b){f.choiceControl.setFilter(a,b)},updateFilter:function(){f.choiceControl.filterItems()},toggleAvailability:function(a){f.choiceControl.toggleAvailability(a)}})}}),window.simpleSharePointFormController.create("form.controlsHelper",[],function(a){"use strict";a.allowCustomValue=function(a){return!!(a.length>0&&"text"==a[a.length-1].getAttribute("type"))}}),window.simpleSharePointFormController.create("form.controls",["utils.object"],function(a,b){"use strict";a.createCurrencyControl=function(c){return b.mixin(a.createNumberControl(c),{getName:function(){return"form.controls.currencyControl"}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object","utils.string","utils.document","base","moment"],function(a,b,c,d,e,f){"use strict";a.createDateControl=function(g){function h(){return!!i.hoursControl}var i,j;return i={dateControl:g.valueContent.getElementsByTagName("input")[0],hoursControl:g.valueContent.getElementsByTagName("select")[0],minutesControl:g.valueContent.getElementsByTagName("select")[1],datePicker:g.valueContent.getElementsByTagName("a")[0],spy:e.createSpyObject({evaluateState:function(){var a=j.getValue();return a?a.toString():null}})},j=b.mixin(a.createBaseControl(g),{getName:function(){return"form.controls.dateControl"},init:function(){[i.dateControl,i.hoursControl,i.minutesControl].filter(function(a){return!!a}).forEach(function(a){d.addEvent(a,"change",function(a){j.trigger("change",{domEvent:a})})}),i.spy.on("clue",function(){j.trigger("change")}),d.addEvent(i.datePicker,"click",function(){i.spy.startTracking()}),d.addEvent(i.dateControl,"focus",function(){i.spy.stopTracking()})},setValue:function(a){var b;b=a instanceof Date?f(a):f(a,g.customization.dateTimeFormat),h()&&(i.hoursControl.value=b.hours(),i.minutesControl.value=c.zeroPad(Math.round(5*Math.floor((b.minutes()||1)/5)),2)),i.dateControl.value=b.format(g.customization.dateFormat)},getValue:function(){return h()?f(c.format("{0} {1}:{2}",i.dateControl.value,c.zeroPad(i.hoursControl.value,2),c.zeroPad(i.minutesControl.value,2)),g.customization.dateFormat+"HH:mm"):f(i.dateControl.value,g.customization.dateFormat)},toggleAvailability:function(a){[i.dateControl,i.hoursControl,i.minutesControl].filter(function(a){return!!a}).forEach(function(b){d.toggleAttribute(b,{name:"disabled",value:"disabled"},!a)}),d.toggleClass(i.datePicker,"simple-sp-form-hidden",!a)}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object","base","utils.document","utils.array","utils.converter"],function(a,b,c,d,e,f){"use strict";a.createLookupControl=function(g){function h(){var a,b;b=i.valueControl.value,a=i.filteredItems,i.filteredItems=[],d.nodeListToArray(i.valueControl.options).forEach(function(b){a.push(i.valueControl.removeChild(b))}),a.sort(function(a,b){return a.order==b.order?0:a.order<b.order?-1:1}).forEach(function(a){i.itemsFilter(c.createLookupValue(+a.value,a.text))?i.valueControl.appendChild(a):i.filteredItems.push(a)}),i.valueControl.value=b,i.valueControl.value!=b&&(i.valueControl.selectedIndex=0)}var i,j;return i={valueControl:g.valueContent.getElementsByTagName("select")[0],items:null,itemsFilter:function(){return!0},filteredItems:[]},j=b.mixin(a.createBaseControl(g),{getName:function(){return"form.controls.lookupControl"},init:function(){d.nodeListToArray(i.valueControl.options).forEach(function(a,b){a.order=b}),i.items=d.nodeListToArray(i.valueControl.options).map(function(a){return c.createLookupValue(+a.value,a.text)}),d.addEvent(i.valueControl,"change",function(a){j.trigger("change",{domEvent:a})})},setValue:function(a){var b=f.toLookupValue(a,i.items);if(null===b)i.valueControl.selectedIndex=0;else if(i.valueControl.value=b.getId(),i.valueControl.value!=b.getId())throw i.valueControl.selectedIndex=0,new Error("lookup value is invalid")},getValue:function(){return i.valueControl.options.selectedIndex==-1?null:e.singleOrNull(i.items,function(a){return a.getId()==i.valueControl.options[i.valueControl.selectedIndex].value})},getItems:function(){return i.items},setFilter:function(a,b){i.itemsFilter=a,b&&b.forEach(function(a){a.on("change",j.updateFilter)}),j.updateFilter()},updateFilter:function(){h()},toggleAvailability:function(a){d.toggleAttribute(i.valueControl,{name:"disabled",value:"disabled"},!a)}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object","base","utils.document","utils.array","utils.converter","utils.string"],function(a,b,c,d,e,f,g){"use strict";a.createLookupMultiControl=function(h){function i(){function a(a){var b;a==n.itemsControl?(b=n.filteredItems,n.filteredItems=[]):b=[],d.nodeListToArray(a.options).forEach(function(c){b.push(a.removeChild(c))}),b.sort(function(a,b){return a.title==b.title?0:a.title<b.title?-1:1}).forEach(function(b){n.itemsFilter(c.createLookupValue(+b.value,b.text))?a.appendChild(b):n.filteredItems.push(b)})}a(n.selectionControl),a(n.itemsControl)}function j(){var a,b;a=h.valueContent.getElementsByTagName("input"),b=h.valueContent.getElementsByTagName("select"),n.hiddenSelection=a[0],n.itemsControl=b[0],n.selectionControl=b[1],n.addItemButton=a[3],n.removeItemButton=a[4],n.items=a[1].value.split("|t |t |t").map(function(a){var b=a.split("|t");return c.createLookupValue(+b[0],b[1])})}function k(a){var b,d;if(b=a.split("|t"),d=[],!(b.length>1))return null;for(var e=0;e<b.length;e+=2)d.push(c.createLookupValue(+b[e],b[e+1]))}function l(a){return null===a||0===a.length?null:a.map(function(a){return g.format("{0}|t{1}",a.getId(),a.getValue().replace("|","||"))}).join("|t")}function m(a){var b=[];[n.itemsControl,n.selectionControl].forEach(function(a){d.nodeListToArray(a.options).forEach(function(c){b.push(a.removeChild(c))})}),b.filter(function(b){return!e.contains(a,+b.value)}).sort(function(a,b){return a.title==b.title?0:a.title<b.title?-1:1}).forEach(function(a){n.itemsControl.appendChild(a)}),b.filter(function(b){return e.contains(a,+b.value)}).forEach(function(b){e.contains(a,+b.value)&&n.selectionControl.appendChild(b)})}var n,o;return n={hiddenSelection:null,itemsControl:null,selectionControl:null,addItemButton:null,removeItemButton:null,items:null,itemsFilter:function(){return!0},filteredItems:[]},o=b.mixin(a.createBaseControl(h),{getName:function(){return"form.controls.lookupMultiControl"},init:function(){j(),[n.addItemButton,n.removeItemButton].forEach(function(a){d.addEvent(a,"click",function(a){o.trigger("change",{domEvent:a})})})},setValue:function(a){var b,c;if(a&&0!==a.length){if(!Array.isArray(a))throw new Error("multi lookup value is not valid");b=a.map(function(a){return f.toLookupValue(a,n.items)}),c=b.map(function(a){return a.getId()})}else b=null,c=[];n.hiddenSelection.value=b?l(b):"",m(c)},getValue:function(){return k(n.hiddenSelection.value)},getItems:function(){return n.items},setFilter:function(a,b){n.itemsFilter=a,b&&b.forEach(function(a){a.on("change",o.updateFilter)}),o.updateFilter()},updateFilter:function(){i()},toggleAvailability:function(a){[n.itemsControl,n.selectionControl,n.addItemButton,n.removeItemButton].forEach(function(b){d.toggleAttribute(b,{name:"disabled",value:"disabled"},!a)}),a&&(d.toggleAttribute(n.addItemButton,{name:"disabled",value:"disabled"},!n.itemsControl.options.length),d.toggleAttribute(n.removeItemButton,{name:"disabled",value:"disabled"},!n.selectionControl.options.length))}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object"],function(a,b){"use strict";a.createNumberControl=function(c){var d;return d={valueControl:c.valueContent.getElementsByTagName("input")[0]},b.mixin(a.createTextControl(c),{getName:function(){return"form.controls.numberControl"},setValue:function(a){if(!b.isNumberOrNull(a))throw new Error("value is not a number");d.valueControl.value=null===a?null:+a},getValue:function(){var a=d.valueControl.value;return""===a?null:+a}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object","utils.document"],function(a,b,c){"use strict";a.createTextControl=function(d){var e,f;return e={valueControl:d.valueContent.getElementsByTagName("input")[0]},f=b.mixin(a.createBaseControl(d),{getName:function(){return"form.controls.textControl"},init:function(){c.addEvent(e.valueControl,"change",function(a){f.trigger("change",{domEvent:a})})},setValue:function(a){e.valueControl.value=a},getValue:function(){return e.valueControl.value},toggleAvailability:function(a){c.toggleAttribute(e.valueControl,{name:"disabled",value:"disabled"},!a)}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object","utils.document"],function(a,b,c){"use strict";a.createUrlControl=function(d){var e,f;return e={valueControl:d.valueContent.getElementsByTagName("input")[0],descriptionControl:d.valueContent.getElementsByTagName("input")[1]},f=b.mixin(a.createBaseControl(d),{getName:function(){return"form.controls.urlControl"},init:function(){[e.valueControl,e.descriptionControl].forEach(function(a){c.addEvent(a,"change",function(a){f.trigger("change",{domEvent:a})})})},setValue:function(a){if("object"==typeof a)e.valueControl.value=a.url,e.descriptionControl.value=a.description;else{if("string"!=typeof a)throw new Error("value is not valid");e.valueControl.value=a}},getValue:function(){return{url:e.valueContent.value,description:e.descriptionControl.value}},toggleAvailability:function(a){[e.valueControl,e.descriptionControl].forEach(function(b){c.toggleAttribute(b,{name:"disabled",value:"disabled"},!a)})}})}}),window.simpleSharePointFormController.create("form.controls",["utils.object","utils.document"],function(a,b,c){"use strict";a.createUserControl=function(d){function e(){f.spClientUserControl.GetAllUserInfo().forEach(function(){f.spClientUserControl.DeleteProcessedUser()})}var f,g;return f={clientInput:d.valueContent.getElementsByClassName("sp-peoplepicker-editorInput")[0],spClientUserControl:null,beforeReadyStateValue:void 0},g=b.mixin(a.createBaseControl(d),{getName:function(){return"form.controls.userControl"},init:function(){d.spClientControlProvider.on("ready",function(a){f.spClientUserControl=a.spClientUserControl,void 0!==f.beforeReadyStateValue&&g.setValue(f.beforeReadyStateValue)})},setValue:function(a){if(null===f.spClientUserControl)return void(f.beforeReadyStateValue=a);if(null===a)e();else if(Array.isArray(a)&&f.spClientUserControl.AllowMultipleUsers)e(),a.forEach(function(a){f.clientInput.value=a,f.spClientUserControl.AddUnresolvedUserFromEditor(!0)});else{if("string"!=typeof a||f.spClientUserControl.AllowMultipleUsers)throw new Error("user value is not valid");e(),f.clientInput.value=a,f.spClientUserControl.AddUnresolvedUserFromEditor(!0)}},getValue:function(){var a;return a=f.spClientUserControl.GetAllUserInfo(),0===a.length?null:a},toggleAvailability:function(a){c.toggleClass(f.clientInput,"simple-sp-form-hidden",!a),c.toggleClass(d.valueContent,"simple-sp-form-disabled-user-field",!a)}})}}),window.simpleSharePointFormController.create("form",["utils.string"],function(a,b){"use strict";a.createFieldLabel=function(a){var c;return c={labelNode:a.labelContent.getElementsByTagName("nobr")[0]},{setLabel:function(a){var d=c.labelNode.innerHTML.match(/<span.+?class="ms-accentText".+?span>/);d=d?d[0]:"",c.labelNode.innerHTML=b.format("{0}{1}",a,d)}}}}),window.simpleSharePointFormController.create("form.fields",["base","utils.object","utils.document"],function(a,b,c,d){"use strict";a.createBaseField=function(a){var e;return{availabilityEvaluator:function(){return!0},visibilityEvaluator:function(){return!0}},e=c.mixin(b.createEventsObject(),{_init:function(){a.control.init(),a.control.on("change",function(a){e.trigger("change",a)})},getName:function(){return"form.fields.baseField"},getInternalName:function(){return a.row.getFieldInternalName()},getTitle:function(){return a.row.getFieldName()},getFieldType:function(){return a.row.getFieldType()},setLabel:function(b){a.label.setLabel(b)},setValue:function(b){a.control.setValue(b)},getValue:function(){return a.control.getValue()},show:function(){d.toggleClass(a.row.getRow(),"simple-sp-form-hidden",!1)},hide:function(){d.toggleClass(a.row.getRow(),"simple-sp-form-hidden",!0)},enable:function(){a.control.toggleAvailability(!0)},disable:function(){a.control.toggleAvailability(!1)},addClass:function(b){d.addClass(a.row.getRow(),b)},removeClass:function(b){d.removeClass(a.row.getRow(),b)}})}}),window.simpleSharePointFormController.create("form.fields",["utils.object"],function(a,b){"use strict";a.createChoiceField=function(c){return b.mixin(a.createBaseField(c),{getName:function(){return"form.fields.choiceField"},getItems:function(){return c.control.getItems()},setFilter:function(a,b){return c.control.setFilter(a,b)},updateFilter:function(){c.control.updateFilter()}})}}),window.simpleSharePointFormController.create("form",["utils.string","utils.object","base","formHelper","utils.sp","window","utils.array"],function(a,b,c,d,e,f,g,h){"use strict";a.createForm=function(a){var i,j;return i={fields:[],fieldsHashTable:{}},f.executeOrDelayUntilEventNotified(function(){Array.prototype.forEach.call(g.document.getElementsByClassName("ms-formtable")[0].children[0].children,function(b){if("idAttachmentsRow"!=b.id){var c=e.mapField({row:b,customization:a.customization});c._init(),i.fields.push(c),i.fieldsHashTable[c.getInternalName()]=c}}),j.trigger("ready")},"sp.bodyloaded"),j=c.mixin(d.createEventsObject(),{getField:function(a){if(!i.fieldsHashTable[a])throw new Error(b.format('form doesn\'t contain field with internal name "{0}"',a));return i.fieldsHashTable[a]},getFieldByTitle:function(a){var c=h.singleOrNull(i.fields,function(b){return b.getTitle()==a});if(!c)throw new Error(b.format('form doesn\'t contain field with the title "{0}"',a));return c},getAllFields:function(){return i.fields},getAllFieldsHashTable:function(){return i.fieldsHashTable}})}}),window.simpleSharePointFormController.create("formHelper",["form.controls","utils.object","form.fields","form","utils.document","utils.array","window","base"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a){function b(){var b=g.singleOrNull(Object.keys(h.SPClientPeoplePicker.SPClientPeoplePickerDict),function(b){return new RegExp("^"+a+"_.{8}-.{4}-.{4}-.{4}-.{12}_\\$ClientPeoplePicker$").test(b)});return h.SPClientPeoplePicker.SPClientPeoplePickerDict[b]}var c,d;return c=i.createSpyObject({evaluateState:function(){return!!h.SPClientPeoplePicker},autostop:!0,autostart:!0}),c.on("clue",function(){d.trigger("ready",{spClientUserControl:b()})}),d=i.createEventsObject()}function k(a){var d,e;switch(d={valueContent:a.valueContent},e=a.customization||{},a.fieldType){case"SPFieldText":return b.createTextControl(d);case"SPFieldNumber":case"SPFieldCurrency":return b.createNumberControl(d);case"SPFieldDateTime":return b.createDateControl(c.mixin(d,{customization:{dateFormat:e.dateFormat,dateTimeFormat:e.dateTimeFormat}}));case"SPFieldLookup":return b.createLookupControl(d);case"SPFieldLookupMulti":return b.createLookupMultiControl(d);case"SPFieldUser":case"SPFieldUserMulti":return b.createUserControl(c.mixin(d,{spClientControlProvider:j(a.internalName)}));case"SPFieldChoice":case"SPFieldOutcomeChoice":return b.createChoiceControl(d);case"SPFieldMultiChoice":return b.createChoiceMultiControl(d);case"SPFieldBoolean":return b.createBooleanControl(d);case"SPFieldURL":return b.createUrlControl(d);default:return b.createBaseControl(d)}}a.mapField=function(a){var b,c,g;switch(b=e.createRowWrapper(a.row),c=e.createFieldLabel({labelContent:b.getLabelContent()}),g=k({internalName:b.getFieldInternalName(),fieldType:b.getFieldType(),valueContent:b.getValueContent(),customization:a.customization}),f.addClass(b.getRow(),"simple-sp-form-field"),f.addClass(b.getValueContent(),"simple-sp-value-content"),b.getFieldType()){case"SPFieldLookup":case"SPFieldLookupMulti":case"SPFieldChoice":case"SPFieldOutcomeChoice":case"SPFieldMultiChoice":return d.createChoiceField({row:b,label:c,control:g});default:return d.createBaseField({row:b,label:c,control:g})}}}),window.simpleSharePointFormController.create("form",[],function(a){"use strict";a.createRowWrapper=function(a){var b,c;return b={labelCell:null,labelContent:null,valueCell:null,valueContent:null,fieldDescription:null,fieldName:null,fieldInternalName:null,fieldType:null},c={getRow:function(){return a},getFieldDescription:function(){return b.fieldDescription||(b.fieldDescription=c.getValueCell().childNodes[1].nodeValue)},getFieldName:function(){return b.fieldName||(b.fieldName=c.getFieldDescription().match(/FieldName="(.+?)"/)[1])},getFieldInternalName:function(){return b.fieldInternalName||(b.fieldInternalName=c.getFieldDescription().match(/FieldInternalName="(.+?)"/)[1])},getFieldType:function(){
return b.fieldType||(b.fieldType=c.getFieldDescription().match(/FieldType="(.+?)"/)[1])},getLabelCell:function(){return b.labelCell||(b.labelCell=c.getRow().children[0])},getLabelContent:function(){return b.labelContent||(b.labelContent=c.getLabelCell().children[0])},getValueCell:function(){return b.valueCell||(b.valueCell=c.getRow().children[1])},getValueContent:function(){return b.valueContent||(b.valueContent=c.getValueCell().children[0])}}}});